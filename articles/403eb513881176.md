---
title: "Jetpack Composeã§è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã®ä½œæˆ"
emoji: "ğŸ‰"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
  - "android"
  - "compose"
  - "animation"
published_at: "2024-11-25 16:31"
published: true
---

`Layout()`ã‚’ä½¿ã£ã¦æ–‡å­—åˆ—ã®ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ã‚‹

<img width="700" src="https://github.com/user-attachments/assets/0abd0a2f-a831-4795-9360-c68b625d8a66" />


```kotlin
@Composable
fun AutoScrollText(
    modifier: Modifier = Modifier,
    text: String,
    style: TextStyle = LocalTextStyle.current,
) {
    val transition = rememberInfiniteTransition(
        label = "AutoScrollTextRepeater"
    )
    val textWidth = remember { mutableIntStateOf(0) }
    val layoutWidth = remember { mutableIntStateOf(0) }

    val transitionWidth = textWidth.intValue

    val animateX: Int by transition.animateValue(
        initialValue = layoutWidth.intValue,
        targetValue = -transitionWidth,
        typeConverter = Int.VectorConverter,
        animationSpec = infiniteRepeatable(
            animation = tween(
                durationMillis = transitionWidth * 15,
                delayMillis = 300,
                easing = LinearEasing
            ),
        )
    )

    Layout(
        modifier = modifier,
        content = {
            Text(
                text = text,
                style = style,
                maxLines = 1,
            )
        },
        measurePolicy = { measurable, constraints ->
            val textMeasurable = measurable.first()

            layoutWidth.intValue = constraints.maxWidth

            val placeable = textMeasurable.measure(
                // layoutã®ã‚µã‚¤ã‚ºã«é–¢ã‚ã‚‰ãšå…¨ã¦ã‚’è¡¨ç¤ºã™ã‚‹
                constraints.copy(maxWidth = Int.MAX_VALUE)
            )
            val fixedWidth = placeable.width
            textWidth.intValue = fixedWidth
            layout(layoutWidth.intValue, placeable.height) {
                placeable.place(animateX, 0)
            }
        }
    )
}

@Preview
@Composable
private fun AutoScrollTextPreview0() {
    Column(
        modifier = Modifier
            .width(100.dp)
    ) {
        AutoScrollText(
            text = "abcdefghijklmnopqrstuvwxyz",
        )
    }
}
```
